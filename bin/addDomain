#! /app/vendor/node/bin/node

herokuEnv = require('./lib/herokuEnv.js');

// get domain arg
if (process.argv.length>2) {
  var domain = process.argv[2];
} else {
  console.log('usage: addDomain domain-name');
  process.exit();
}

var info = require('./lib/prerenderInfo');

info.update().then(function (info) {
  console.log('whitelist: ', info.whiteList);
})
.then(function () {
  if (info.whiteList.indexOf(domain)<0) {
    info.whiteList.push(domain);
    return herokuEnv.setEnv('ALLOWED_DOMAIN_TEST', info.whiteList.join(','));
  }
});

// add to heroku env


// crawl domain with prerender
